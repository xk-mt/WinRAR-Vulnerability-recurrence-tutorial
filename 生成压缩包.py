import shutil
import os
import random

打开文件 = '文本.txt'
执行文件 = '执行命令.bat'
随机目录 = str(random.randint(0, 9))
文件后缀 = bytes(os.path.splitext(打开文件)[-1], 'u8')

if os.path.exists(随机目录):shutil.rmtree(随机目录)
os.mkdir(随机目录)
d = os.path.join(随机目录, 打开文件 + "A")
os.mkdir(d)
shutil.copyfile(执行文件, os.path.join(d, 打开文件+"A.cmd"))
shutil.copyfile(打开文件, os.path.join(随机目录, 打开文件+"B"))
shutil.make_archive(随机目录, 'zip', 随机目录)
content = open(随机目录 + ".zip", "rb").read()
os.remove(随机目录 + ".zip")
shutil.rmtree(随机目录)
content = content.replace(文件后缀 + b"A", 文件后缀 + b" ")
content = content.replace(文件后缀 + b"B", 文件后缀 + b" ")

open('结果.zip', "wb").write(content)

input("文件：结果.zip\n\n按回车结束")